# Техническое описание реализации сервиса для визуализации данных и обучения моделей машинного обучения 

## 1. Архитектура проекта

Проект представляет собой интеграцию API на основе FastAPI и интерфейса для взаимодействия с пользователем через Streamlit.

### Основные компоненты:
- **API (FastAPI)**: Обеспечивает серверное взаимодействие с моделями машинного обучения и управление обучением, прогнозированием и метаданными моделей.
- **Интерфейс (Streamlit)**: Визуализация данных, взаимодействие с пользователем и интеграция с API для выполнения запросов и отображения результатов.
- **Модели машинного обучения**: Базовая предобученная модель логистической регрессии\возможность выбора модели и гиперпараметров.

## 2. Структура данных и взаимодействие между компонентами

### Взаимодействие с API
Этот API предоставляет доступ к моделям для предсказания исходов игр Dota2 (Radiant/Dire). API позволяет обучать модели, получать информацию о состоянии задач, предсказывать исходы матчей.

**API**, созданное с использованием FastAPI, предоставляет несколько ключевых эндпоинтов для работы с системой:

- **`GET /`** — Точка проверки доступности сервиса. Возвращает информацию о текущем состоянии API, например, статус сервиса или версии.
  
- **`POST /api/v1/models/fit`** — Эндпоинт для начала процесса обучения модели. Запрос включает данные, такие как тип модели, гиперпараметры и файл с обучающими данными. 

- **`GET /api/v1/models/fit/status`** — Возвращает статус текущей задачи обучения, например, прогресс обучения модели или её завершение. 

- **`POST /api/v1/models/predict`** — Эндпоинт для выполнения предсказания с использованием обученной модели. 

- **`POST /api/v1/models/predict_csv`** — Позволяет загрузить CSV файл с данными и выполнить массовое прогнозирование для каждого набора данных в файле.

- **`GET /api/v1/models/list`** — Возвращает список всех обученных моделей.

- **`GET /api/v1/models/model_info`** — Предоставляет подробную информацию о модели, такую как её тип, гиперпараметры, метрики точности и другие характеристики.

- **`GET /api/v1/data/account_ids`** — Возвращает список доступных account_id игроков для предсказания или анализа.

- **`PUT /api/v1/models/activate`** - Установка активной модели для прогноза.
  
- **`GET /api/v1/data/account_ids`** - Получение списка всех account_id игроков.

### Обучение и инференс

Для обучения и инференса моделей в проекте используется несколько технологий:

- **Обучение моделей**:
  - Для обучения моделей машинного обучения используется библиотеки `scikit-learn`, `CatBoost`.
  - Процесс обучения включает в себя подготовку данных, настройку гиперпараметров и запуск обучения на сервере.

- **Предсказания**:
  - После обучения модель сохраняется. Для инференса модель загружается в память и используется для выполнения прогнозов на новых данных.

## 3. Streamlit-приложение

Streamlit-приложение реализует пользовательский интерфейс, который позволяет пользователям взаимодействовать с системой и получать результаты предсказаний.

- **Загрузка данных**:
  Пользователь может загрузить файл с данными для анализа или для обучения модели. Это делается с использованием компонента `file_uploader` в Streamlit.

- **Визуализация EDA**:
  Для анализа данных пользователю предоставляются графики и визуализации, которые строятся с использованием библиотеки `plotly`. 

- **Обучение модели**:
  Интерфейс позволяет пользователю выбрать модель, установить гиперпараметры и запустить процесс обучения. 

- **Получение предсказаний**:
  В интерфейсе есть возможность загрузить новые данные (например, составы команд), выбрать модель и получить прогноз на основе данных.

## 4. Технологии и инструменты

### Основные технологии:
- **FastAPI** — Для создания быстрого и эффективного RESTful API, с возможностью асинхронного выполнения задач.
- **Streamlit** — Для создания простого и интерактивного пользовательского интерфейса.
- **Scikit-learn, CatBoost** — Для реализации моделей машинного обучения, включая как классические алгоритмы, так и глубокие нейронные сети.
- **Pandas** — Для обработки и анализа данных, включая загрузку данных и манипуляции с ними.

## 5. Обработка запросов и асинхронность

Асинхронная обработка задач позволяет эффективно управлять запросами, которые требуют длительных вычислений, таких как обучение моделей. FastAPI поддерживает асинхронные операции через `asyncio`.

## 6. Заключение

Техническая реализация проекта позволяет пользователям выполнять полный цикл работы с моделями машинного обучения: от анализа данных и обучения моделей до выполнения прогнозов и получения результатов через удобный интерфейс. В основе лежат FastAPI для взаимодействия с API и Streamlit для визуализации данных и взаимодействия с пользователем, что делает проект гибким и масштабируемым.

